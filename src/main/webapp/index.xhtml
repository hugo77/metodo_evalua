<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

    <h:head>
        <script src="http://js.pusher.com/2.1/pusher.min.js" type="text/javascript"></script>
        <script type="text/javascript">
        //<![CDATA[

        Pusher.log = function(message) {
            if (window.console && window.console.log) {
                window.console.log(message);
            }
        };

        var pusher = new Pusher('59cb3ed47c36fd6c1558');
        var channel = pusher.subscribe('test_channel');
        channel.bind('my_event', function(data) {
            var from = data.from;
            var txt  = new Date() + " " + from + ":\n" + $.trim(data.message) + "\n";
            var box  = $("#chat\\:messages");
            box.val(box.val() + txt);
        });
        //]]>
        </script>
    </h:head>
    <h:body>
        <h1>Simple chat with pusher</h1>
        <h:form id="chat" name="chat">
            <p:inputTextarea rows="10" cols="100" readonly="true" id="messages"/>
        </h:form>
    </h:body>
</html>